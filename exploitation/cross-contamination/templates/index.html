<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>People Directory</title>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</head>
<body>
    <!-- <script>loadDirectory({{ directory|tojson }})</script> -->
    <h1>Add a Cool Dude below! </h1>
    <p>(The Cool Dudes directory has been updated! We realized that things can get confusing if two of 'em live together, so use the "combine dudes" button to consolidate their pages!)</p>
    <form method="post" action="/add">
        <input type="text" name="name" placeholder="Name" required></br>
        <input type="text" name="likes" placeholder="Likes" required></br>
        <input type="text" name="dislikes" placeholder="Dislikes" required></br>
		<textarea name="bio" placeholder="Bio" required></textarea></br>

        <button type="submit">Add Person</button>
    </form>
    <h2>Directory</h2>
    <ul>
        {% for name in directory.keys() %}
            <li><a href="/person/{{ name }}">{{ name }}</a></li>
        {% endfor %}
    </ul>



    <label for="selectPerson">Select a person:</label>
    <form id="updateForm">
        <input type="text" name="item" placeholder="New info category" required></br>
		<textarea name="info" placeholder="New info" required></textarea></br>

        
        <select name="selectPerson" id="selectPerson">
            <option value="" disabled selected>Select a person</option>
            {% for name in directory.keys() %}
                <option value="{{ name }}">{{ name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Update Dude!</button>
    </form>
    <script>
        loadDirectory().then(directory => {
            document.getElementById('updateForm').addEventListener('submit', function(event) {
                event.preventDefault();
                let select = document.getElementById("selectPerson");
                let name = select.value;
                let info = directory[name];
                console.log("info here: ", info);
                console.log("directory here: ", directory);
                updatePerson(event, info, name); 
            }); 
        });
    </script>
    <button onclick="newTestDude();">Add Test Dude</button>
</body>
</html>